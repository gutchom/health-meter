<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>メンタルグラフ</title>

    <script defer src="/__/firebase/7.14.2/firebase-app.js"></script>
    <script defer src="/__/firebase/7.14.2/firebase-auth.js"></script>
    <script defer src="/__/firebase/7.14.2/firebase-database.js"></script>
    <script defer src="/__/firebase/init.js"></script>

    <script type="text/javascript" src="https://kit.fontawesome.com/e26bc99bde.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="/css/app.css">
  </head>
  <body>
    <div id="page">
      <header class="global-header">
        <h1>メンタルグラフ</h1>
        <button id="login" type="button" style="color: #fff">サインイン</button>
      </header>
    </div>

    <main id="app"></main>

    <script type="text/javascript" src="/js/vendor.js"></script>
    <script type="text/javascript" src="/js/app.js"></script>

    <script type="text/javascript">
      document.addEventListener('DOMContentLoaded', function() {

        login.addEventListener('click', function (e) {
          e.preventDefault()

          var provider = new firebase.auth.TwitterAuthProvider();

          firebase.auth().signInWithPopup(provider).then(function (result) {
            // This gives you a the Twitter OAuth 1.0 Access Token and Secret.
            // You can use these server side with your app's credentials to access the Twitter API.
            var token = result.credential.accessToken;
            var secret = result.credential.secret;
            // The signed-in user info.
            var user = result.user;
            // ...
            console.log(token)
            console.log(secret)
            console.log(user)

            page.style.display = 'none'

            window.photoURL = user.photoURL
            window.loginCompleted()

          }).catch(function (error) {
            // Handle Errors here.
            var errorCode = error.code;
            var errorMessage = error.message;
            // The email of the user's account used.
            var email = error.email;
            // The firebase.auth.AuthCredential type that was used.
            var credential = error.credential;
            // ...
          });
        })
      })
    </script>
  </body>
</html>
